<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link rel="shortcut icon" href="{{url_for('static' , filename = 'img/fav.png')}}" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{url_for('static' , filename ='css/result.css' )}}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>WariTchek - Go Deals pour {{ query }}</title>
</head>
<body>
    
        <form method="get"  style="width:100%; max-width:700px;margin-bottom:30px; ">
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="search" name="q" value="{{ query }}" placeholder="Rechercher un produit...">
                <button type="button" id="dropdownToggle">
                    <i class="fas fa-sliders-h" style="font-size:1.3em; color:#eab581;"></i>
                </button>
            </div>
            <div id="advancedDropdown">
                <div class="form-group">
                    <label for="search-type" id="label">Type de recherche <i class="fa-solid fa-bolt"></i> / <i class="fa-solid fa-clock"></i></label>
                    <select id="search-type" name="search-type" style="width:100%;">
                        <option value="fast"><p>Rapide</p></option>
                        <option value="deep">Approfondie</option>
                    </select>
                </div>
                 <div class="form-group">
                        <div class="dropdown">
                        <button class="dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false" >
                            Sites
                        </button>
                        <ul class="dropdown-menu" id="dropdown-menu" aria-labelledby="dropdownMenuButton1" >
                            <li>  
                                <div class="form-check" > 
                                    <label for="" class="form-check-label">Jumia.ci</label> 
                                    <input type="checkbox" name="jumia" id="" class="form-check-input" value = 'True'> 
                                    
                                </div>
                               
                            </li>
                            <hr>
                            <li>  

                               
                            </li>
                            <hr>
                            <li>  
                                <div class="form-check"> 
                                    <label for="" class="form-check-label">Mr.Gadget</label>
                                    <input type="checkbox" name="mrgadget" id="" class="form-check-input" value = 'True'> 
                                     
                                </div>
                               
                            </li>
                        </ul>
                    </div>
                    </div>
                <div class="form-group">
                    <label for="min-price" id="label">Prix min (FCFA)</label>
                    <input type="number" placeholder="1000" min="100" name="min-price" value="1000" id="input" style="width:100%;">
                </div>
                <div class="form-group">
                    <label for="max-price" id="label">Prix max (FCFA)</label>
                    <input type="number" placeholder="100000" min="1000" name="max-price" value="10000000" id="input" style="width:100%;">
                </div>
                
                
            </div>
            <div class="btns">
                <button class="btn btn-primary" id ='btn-primary' type="submit">Recherche Price Tracker</button>
            </div>

            

        </form>
    
              <section > 
                <div class="results-header">
                    <h2 class="section-title">
                        <i class="fas fa-list"></i>
                        Resultats 
                    </h2>
                    
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-number">{{name_count}}</div>
                            <div class="stat-label">Produits</div>
                            
                        </div>
                       
                  


                    </div>
                    <div class="filters">
                        
                        <button class="btn-filter active">Tous</button>
                        <button class="btn-filter">Alertes</button>
                        <button class="btn-filter">Nouveaux</button>
                        
                    </div>
                </div>

                <div class="products-grid">
                    <!-- CARTE PRODUIT 1 -->
 {%for item in inventaire%}
                    <div class="product-card">
                        <div class="info-grid">
                            <div class="info-item">
                                <img src="{{item.img}}" alt="" style="width: 250px;">
                            </div>
                        </div>
                        <div class="product-header">
                            <div>
                                <h3 class="product-title">{{item.name}}</h3>
                                <span class="product-site">{{item.origin}}</span>
                           
                            </div>
                        </div>
                        
                        <div class="product-price">
                           {{item.price}} FCFA 
                           {%if item.reduction != 0 %}
                           <span class="price-change price-down"> -{{item.reduction}}%</span>
                           {%endif%}
                        </div>
                        
                        
                        <p class="product-info">iPhone en excellent état, batterie 95%, avec facture et accessoires.</p>
                        
                        <div class="info-grid">
                            <div class="info-item">
                                
                                {%if item.quant != 'N/A'%}
                                <i class="fa-solid fa-triangle-exclamation" style="color: red;"></i><span>Il n'en reste que <span style="color: red; font-weight:bold;">{{item.quant}}</span></span>
                                {%else%}
                                <span>Il n'yen a assez</span>
                                {%endif%}
                            </div>
                            <div class="info-item">
                                <i class="fa-solid fa-eye"></i>
                                {%if item.origin == 'Jumia.ci' %}
                                <span>État: Neuf</span>
                                {%endif%}

                            </div>
                            <div class="info-item">
                                <i class="fas fa-clock"></i>
                                {%if item.date !='N/A'%}
                                <span>Il y a {{item.date}}</span>
                                {% else %}
                                <span>N/A</span>
                                {% endif %}
                            </div> 
                            <div class="info-item">
                                <span>
                                {% if item.rate != 'N/A'%}
                                    {% if 1 >= item.rate > 0 %}
                                        <i class="fa-solid fa-star" style=' color: #ffd250;'></i>
                                    {% elif 2 >= item.rate > 1%}
                                    <i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i>
                                    {%elif 3 >= item.rate > 2%}
                                    <i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i>
                                    {%elif 4 >= item.rate > 3%}
                                    <i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i>
                                    {%elif 5 >= item.rate > 4%}
                                    <i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i><i class="fa-solid fa-star" style=' color: #ffd250;'></i>
                                    {%endif%}
                                {%else%}
                                    <i class="fa-solid fa-star" style=' color: #ffd250;'></i> ?
                                    {%endif%}
                                    {{item.rate}}
                                </span>
                            </div>
                        </div> 
                        
                       
                        <div class="product-actions">
                            <a class="btn-secondary" href="{{item.link}}" style="text-decoration: none;color:#eab581;" target="_blank">Voir l'annonce</a>
                           
                        </div>
                    </div>
{%endfor%}

                </div>
            </section>
      
 <script>
    document.getElementById('dropdownToggle').onclick = function() {
        var dropdown = document.getElementById('advancedDropdown');
        dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
    };
    document.addEventListener('click', function(e) {
        var toggle = document.getElementById('dropdownToggle');
        var dropdown = document.getElementById('advancedDropdown');
        if (!toggle.contains(e.target) && !dropdown.contains(e.target)) {
            dropdown.style.display = 'none';
        }
    });
    </script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>